# 練習 6: 提示模板系統

## 概述
學習如何實作MCP提示模板系統，創建可重用、參數化的提示模板。這個練習展示了如何使用MCP的Prompts功能來標準化和簡化複雜的提示生成。

## 先決條件
- 完成練習 1-5
- 理解提示工程基礎概念
- 熟悉模板設計模式
- 了解參數化和條件邏輯

## 學習目標
- [ ] 掌握MCP提示模板的註冊和實作
- [ ] 學習提示參數化設計技巧
- [ ] 理解不同類型提示模板的應用場景
- [ ] 實作結構化提示生成邏輯
- [ ] 掌握消息格式和內容組織

## 技術要點
- **registerPrompt方法**: MCP提示註冊機制
- **參數化設計**: 使用Zod進行參數驗證和類型安全
- **消息格式**: MCP標準的消息結構
- **模板重用**: 設計可重用的提示模板

## 實作要求

### 繼承功能
保留練習 1-5 的所有功能：
- Echo 工具和基本工具
- 靜態資源和動態資源
- 文件操作和HTTP模擬
- 數據處理和錯誤處理

### 新增提示模板

#### 1. 代碼審查模板 (`code-review`)
- **功能**: 生成結構化的代碼審查提示
- **參數**:
  - `language`: 程式語言
  - `codeContext`: 代碼背景和用途
  - `focusAreas`: 審查重點領域 (可選)
  - `severity`: 審查嚴重程度 (low/medium/high)
- **輸出**: 包含審查指導和檢查清單的提示

#### 2. 文檔生成模板 (`documentation`)
- **功能**: 創建各種類型的文檔模板
- **參數**:
  - `type`: 文檔類型 (api/function/class/module/readme)
  - `name`: 要文檔化的項目名稱
  - `description`: 簡要描述 (可選)
  - `includeExamples`: 是否包含使用範例
  - `targetAudience`: 目標受眾 (developer/user/admin)
- **輸出**: 結構化的文檔編寫指導

#### 3. 錯誤報告模板 (`bug-report`)
- **功能**: 生成標準化的錯誤報告格式
- **參數**:
  - `severity`: 錯誤嚴重程度 (critical/high/medium/low)
  - `component`: 發生錯誤的組件
  - `environment`: 環境資訊 (可選)
  - `reproducible`: 是否可重現
  - `userImpact`: 對用戶的影響 (可選)
- **輸出**: 完整的錯誤報告模板

#### 4. 會議總結模板 (`meeting-summary`)
- **功能**: 創建會議總結和行動項目
- **參數**:
  - `meetingType`: 會議類型 (standup/planning/retrospective/review/general)
  - `duration`: 會議時長 (可選)
  - `attendees`: 參與者列表 (可選)
  - `includeActionItems`: 是否包含行動項目
  - `includeDecisions`: 是否包含決定記錄
- **輸出**: 結構化的會議總結模板

## 開始實作

### 步驟 1: 環境設置
```bash
cd exercises/06-prompt-templates
npm install  # 如果需要
```

### 步驟 2: 理解提示註冊模式
```typescript
server.registerPrompt(
  'prompt-name',
  {
    title: '人類可讀的標題',
    description: '詳細描述提示的用途',
    inputSchema: {
      // Zod 參數驗證架構
    }
  },
  async (parameters) => {
    // 提示生成邏輯
    return {
      messages: [
        {
          role: 'user',
          content: {
            type: 'text',
            text: '生成的提示內容'
          }
        }
      ]
    };
  }
);
```

### 步驟 3: 設計參數架構
每個提示模板需要定義：
- **必要參數**: 核心功能所需
- **可選參數**: 增強功能
- **預設值**: 合理的預設設定
- **類型驗證**: 確保參數正確性

### 步驟 4: 實作條件邏輯
根據參數生成不同的提示內容：
- 嚴重程度影響詳細程度
- 類型影響結構和格式
- 受眾影響語言風格
- 可選功能影響內容包含

### 步驟 5: 消息格式設計
- **role**: 指定消息發送者 ('user', 'assistant', 'system')
- **content**: 結構化內容物件
- **type**: 內容類型 ('text', 'image', 等)

### 步驟 6: 測試驗證
```bash
npm run build
npm run test:06
```

## 驗收標準
- [ ] 服務器成功啟動並註冊所有提示模板
- [ ] 所有繼承的功能正常工作
- [ ] 代碼審查模板生成適當的審查指導
- [ ] 文檔模板根據類型和受眾調整內容
- [ ] 錯誤報告模板包含完整的報告結構
- [ ] 會議總結模板根據類型生成相關內容
- [ ] 所有參數驗證正確工作
- [ ] 消息格式符合MCP標準

## 常見問題

### Q: 如何設計有效的提示參數？
A: 考慮核心功能需求、用戶便利性和擴展性。使用有意義的預設值和清晰的描述。

### Q: 如何處理複雜的條件邏輯？
A: 將條件邏輯分解為小的、可測試的函數。使用策略模式處理不同的參數組合。

### Q: 如何確保生成的提示品質？
A: 設計清晰的結構、使用一致的格式、提供具體的指導而非抽象的描述。

### Q: 如何平衡靈活性和簡單性？
A: 提供合理的預設值，讓簡單使用案例不需要複雜配置，同時支援進階自訂。

## 提示設計最佳實踐

### 結構化設計
- 使用清晰的章節標題
- 採用編號或項目符號
- 保持一致的格式風格

### 內容組織
- 從一般到具體
- 重要資訊放在前面
- 使用範例說明概念

### 參數化策略
- 核心參數影響主要結構
- 可選參數增強細節
- 預設值覆蓋常見需求

### 用戶體驗
- 清晰的錯誤信息
- 有意義的參數描述
- 直觀的參數命名

## 延伸學習
- 探索更複雜的提示模式
- 學習提示鏈接和組合
- 研究自適應提示生成
- 了解提示品質評估方法

## 參考資料
- [MCP 提示規範](../../../mcp-typescript-sdk.md#prompts)
- [提示工程最佳實踐](../../../docs/prompt-engineering.md)
- [模板設計模式](../../../docs/template-patterns.md)
- [參數驗證指南](../../../docs/parameter-validation.md)